(this.webpackJsonp2048=this.webpackJsonp2048||[]).push([[0],[,,,,,,,,,,,,,function(t,e,n){},function(t,e,n){},,function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){"use strict";n.r(e);var r=n(1),i=n.n(r),c=n(8),o=n.n(c),a=(n(13),n(3)),s=n(4),u=n(2),l=[0,1,2,3],f=function(t,e){var n,r;return null===t&&null===e||(t&&(null===(n=Object.keys(t))||void 0===n?void 0:n.length))===(e&&(null===(r=Object.keys(e))||void 0===r?void 0:r.length))&&Object.keys(t).every((function(n){return t[n]===e[n]}))},d=function(t,e){return j(t,(function(t){return t.positionY}),(function(t,e){return t.positionY=e}),e)},v=function(t,e){return j(t,(function(t){return t.positionX}),(function(t,e){return t.positionX=e}),e)},j=function(t,e,n,r){if(0===t.length)return[];var i=JSON.parse(JSON.stringify(t));i.sort((function(t,n){return e(t)-e(n)}));for(var c="left"===r?0:4-i.length,o=0;o<i.length;o++)n(i[o],c+o);"left"===r&&i.reverse();for(var a=i.length-1;a>=1;)if(i[a].value!==i[a-1].value||2048===i[a].value)a--;else{for(var s=0;s<=a-1;s++){var u="right"===r?1:-1;n(i[s],e(i[s])+u)}a-=2}return i},b=function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2,e=[];t>0;)e=[].concat(Object(s.a)(e),[h(e)]),t--;return e},h=function(t){var e=function(t){return[Math.floor(t/4),t%4]};Math.floor(16*Math.random());for(var n=Math.floor(16*Math.random()),r=e(n);O.apply(void 0,[t].concat(Object(s.a)(r)));)r=e(n=15===n?0:n+1);var i=Math.random()<.05?4:2;return{id:g(t),value:i,type:"new",positionX:r[0],positionY:r[1]}},O=function(t,e,n){return t.some((function(t){return t.positionX===e&&t.positionY===n}))},m=function(t,e){return t.filter((function(t){return t.positionX===e}))},p=function(t,e){return t.filter((function(t){return t.positionY===e}))},g=function(t){return y(t)+1},y=function(t){return Math.max.apply(Math,[0].concat(Object(s.a)(t.map((function(t){return t.id})))))},x={up:function(t){return l.map((function(e){return v(p(t,e),"left")})).flat()},down:function(t){return l.map((function(e){return v(p(t,e),"right")})).flat()},right:function(t){return l.map((function(e){return d(m(t,e),"right")})).flat()},left:function(t){return l.map((function(e){return d(m(t,e),"left")})).flat()}},w=420,E=520,N=73,S=97,C=121,M={ArrowUp:"up",ArrowDown:"down",ArrowRight:"right",ArrowLeft:"left",w:"up",s:"down",d:"right",a:"left"},R=(n(14),n(0)),A=Object(r.memo)((function(t){return Object(R.jsx)("div",{className:"tile tile-".concat(t.value),style:{transform:"translate(".concat(t.x,"px, ").concat(t.y,"px)")},children:Object(R.jsx)("div",{className:"tileInner ".concat(t.type),children:t.value})})})),I=(n(16),function(t){return Object(R.jsx)("div",{children:t.tiles.map((function(e){return Object(R.jsx)(A,{value:e.value,type:e.type,x:e.positionY*t.factor,y:e.positionX*t.factor},e.id)}))})}),P=function(t){var e=Object(r.useState)(k()),n=Object(a.a)(e,2),i=n[0],c=n[1];Object(r.useEffect)((function(){var t=function(){c(k())};return window.addEventListener("resize",t),function(){return window.removeEventListener("resize",t)}}),[]);var o=t.tiles.sort((function(t,e){return t.id-e.id}));return Object(R.jsx)("div",{className:"tileContainer",children:Object(R.jsx)(I,{tiles:o,factor:i})})},k=function(){return window.innerWidth<=w?N:window.innerWidth<=E?S:C},L=(n(17),function(t){var e=t.id,n=t.children,r=t.className,i=t.onClick;return Object(R.jsx)("button",{id:e,className:"appButton ".concat(r||""),onClick:i,children:n})}),W={WIN:{message:"Congratulations! You Win!",buttonText:"Play again",containerClass:"gameResultWin"},GAME_OVER:{message:"Game Over!",buttonText:"Try again",containerClass:"gameResultLose"}},Y=function(t){var e=t.isWin,n=t.onContinue,r=t.onRestart,i=t.playAfterWin,c=e||i?W.WIN:W.GAME_OVER,o=c.message,a=c.buttonText,s=c.containerClass;return Object(R.jsxs)("div",{className:"gameResult ".concat(s),children:[Object(R.jsx)("p",{children:o}),Object(R.jsxs)("div",{children:[e&&Object(R.jsx)(L,{className:"continueButton",onClick:function(){return n()},children:"Continue"}),Object(R.jsx)(L,{onClick:function(){return r()},children:a})]})]})},T=function(t){var e=lt(),n=e.gameState,r=e.dispatch,i=n.status,c=t.tiles.some((function(t){return 2048===t.value}));return Object(R.jsx)(R.Fragment,{children:"IN_PROGRESS"!==i&&"PLAY_AFTER_WIN"!==i&&Object(R.jsx)(Y,{isWin:"WIN"===i,playAfterWin:c,onRestart:function(){r({type:"restart"})},onContinue:function(){r({type:"continue"})},status:i})})},_=function(){var t=Array.from(Array(4).keys()).map((function(t){var e=Array.from(Array(4).keys()).map((function(t){return Object(R.jsx)("div",{className:"cell"},t)}));return Object(R.jsx)("div",{className:"row",children:e},t)}));return Object(R.jsx)("div",{className:"gridContainer",children:t})},G=function(t){return Object(R.jsxs)("div",{id:"boardContainer",children:[Object(R.jsx)(T,{tiles:t.tiles}),Object(R.jsx)(_,{}),Object(R.jsx)(P,{tiles:t.tiles})]})},X=(n(18),function(){var t=lt().gameState,e=Object(r.useReducer)(B,F()),n=Object(a.a)(e,2),i=n[0],c=n[1];return Object(r.useEffect)((function(){c({type:"addMove",payload:t})}),[t]),Object(r.useEffect)((function(){i.moves.length<2||i.loading||(c({type:"startMove"}),setTimeout((function(){c({type:"endMove"})}),100))}),[i]),Object(R.jsx)(G,{tiles:i.tiles})});function B(t,e){switch(e.type){case"addMove":return!e.payload.lastMove||0===t.tiles.length?F(e.payload):Object(u.a)(Object(u.a)({},t),{},{moves:[].concat(Object(s.a)(t.moves),[e.payload])});case"startMove":var n=t.moves[0],r=t.moves[1],i=x[r.lastMove](n.tiles);return Object(u.a)(Object(u.a)({},t),{},{loading:!0,tiles:i});case"endMove":var c=t.moves[1];return{moves:t.moves.slice(1),loading:!1,tiles:c.tiles};default:throw new Error("Unhandled action: ".concat(e))}}var F=function(t){return t?{moves:[t],loading:!1,tiles:t.tiles}:{moves:[],loading:!1,tiles:[]}},J=null,U=null,V=function(){var t=lt().dispatch;return Object(r.useEffect)((function(){function e(t){if(1===t.touches.length){var e=t.touches[0];J=e.clientX,U=e.clientY}}function n(e){if(J&&U&&!(e.touches.length>0)){var n=e.changedTouches[0],r=n.clientX,i=n.clientY,c=J-r,o=U-i;Math.abs(c)>Math.abs(o)?t(c<0?{type:"move",payload:"right"}:{type:"move",payload:"left"}):t(o<0?{type:"move",payload:"down"}:{type:"move",payload:"up"}),J=null,U=null}}var r=document.getElementById("boardContainer");return r.addEventListener("touchstart",e),r.addEventListener("touchend",n),function(){r.removeEventListener("touchstart",e),r.removeEventListener("touchend",n)}}),[t]),Object(R.jsx)(X,{})},D=(n(19),"2048-game"),z=function(t,e){return"function"===typeof e?e(t):e},q=function(t,e){try{var n=JSON.parse(window.localStorage.getItem(D)),r=null===n||void 0===n?void 0:n[t];return null!==r&&void 0!==r?r:e}catch(i){return console.log(i),e}};var H=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:z,i=Object(r.useReducer)(n,q(t,e)),c=Object(a.a)(i,2),o=c[0],s=c[1];return Object(r.useEffect)((function(){var e=JSON.parse(window.localStorage.getItem(D))||{};e[t]=o,window.localStorage.setItem(D,JSON.stringify(e))}),[o,t]),[o,s]},K=(n(20),function(t){return Object(R.jsxs)("div",{className:"scoreBox",children:[Object(R.jsx)("span",{className:"title",children:t.title}),Object(R.jsx)("span",{className:"score",children:t.score})]})}),Q=(n(21),function(){var t=lt().gameState,e=H("scores",Z(),tt),n=Object(a.a)(e,2),i=n[0],c=n[1];return Object(r.useEffect)((function(){c({type:"change",payload:t.tiles})}),[t.tiles,c]),Object(r.useEffect)((function(){if(i.newPoints>0){var t=document.getElementById("additionScore");t.innerText="+".concat(i.newPoints);var e=t.cloneNode(!0);t.parentNode.replaceChild(e,t)}}),[i]),Object(R.jsxs)("div",{className:"scoresContainer",children:[Object(R.jsxs)("div",{style:{position:"relative"},children:[Object(R.jsx)(K,{title:"SCORE",score:i.score}),Object(R.jsx)("div",{className:"addScore",id:"additionScore"})]}),Object(R.jsx)(K,{title:"BEST",score:i.bestScore})]})}),Z=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return{score:0,newPoints:0,bestScore:0,tiles:t}},$=function(t,e){return t.some((function(t){return t.id===e.id}))},tt=function(t,e){switch(e.type){case"change":var n=e.payload;if(t.tiles.length===n.length&&t.tiles.every((function(t){return $(n,t)})))return t;if(2===n.length&&[1,2].every((function(t){return n.find((function(e){return e.id===t}))}))&&!t.tiles.every((function(t){return $(n,t)})))return Object(u.a)(Object(u.a)({},Z(n)),{},{bestScore:t.bestScore});if(t.tiles.every((function(t){return $(n,t)}))&&n.length===t.tiles.length+1)return Object(u.a)(Object(u.a)({},t),{},{tiles:n,newPoints:0});var r=y(n),i=n.reduce((function(e,n){return e+(n.id===r||$(t.tiles,n)?0:n.value)}),0),c=t.score+i,o=Math.max(c,t.bestScore);return{tiles:n,newPoints:i,score:c,bestScore:o};default:throw new Error("Unhandled action type: ".concat(e.type))}},et=(n(22),function(){return Object(R.jsx)("span",{className:"gameTitle",children:"2048"})}),nt=function(){return Object(R.jsxs)("div",{children:[Object(R.jsxs)("span",{children:["Join the numbers to get ",Object(R.jsx)("b",{children:"2048"}),"!"]}),Object(R.jsx)("br",{})]})},rt=function(){var t=lt().dispatch;return Object(R.jsxs)("div",{className:"header",children:[Object(R.jsxs)("div",{className:"gameIntro",children:[Object(R.jsx)(et,{}),Object(R.jsx)(nt,{})]}),Object(R.jsxs)("div",{className:"actions",children:[Object(R.jsx)(Q,{}),Object(R.jsx)(L,{id:"restartGameBtn",onClick:function(e){return t({type:"restart"})},children:"New Game"})]})]})},it=i.a.createContext(null),ct=function(t){return function(t){if(t.length<16||function(t){for(var e={},n=0;n<t.length;n++){var r="".concat(t[n].positionX).concat(t[n].positionY);if(e[r])return!0;e[r]=!0}return!1}(t))return!1;for(var e=function(t,e,n){return t.some((function(t){return e.some((function(e){return n(t)===n(e)&&t.value===e.value}))}))},n=0;n<3;n++)if(e(m(t,n),m(t,n+1),(function(t){return t.positionY}))||e(p(t,n),p(t,n+1),(function(t){return t.positionX})))return!1;return!0}(t)?"GAME_OVER":function(t){return t.some((function(t){return 2048===t.value}))}(t)?"WIN":"IN_PROGRESS"},ot=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2;return{tiles:b(t),lastMove:null,status:"IN_PROGRESS"}};function at(t,e){switch(e.type){case"restart":return ot();case"continue":return Object(u.a)(Object(u.a)({},t),{},{status:"PLAY_AFTER_WIN"});case"move":var n=(0,x[e.payload])(t.tiles);if(c=t.tiles,o=n,c.every((function(t){return o.some((function(e){return f(t,e)}))})))return t;n=function(t){var e=g(t),n={};return t.forEach((function(t){var r="".concat(t.positionX).concat(t.positionY);if(n[r]){var i=2*t.value;n[r]=Object(u.a)(Object(u.a)({},t),{},{id:e++,value:i,type:"merged"})}else n[r]=t})),Object.values(n)}(n),n=[].concat(Object(s.a)(n),[h(n)]);var r=ct(n),i="PLAY_AFTER_WIN"!==t.status||"GAME_OVER"===r;return{tiles:n,lastMove:e.payload,status:i?r:t.status};default:throw new Error("Unhandled action: ".concat(e))}var c,o}var st=function(t){var e=H("game",ot(),at),n=Object(a.a)(e,2),i=n[0],c=n[1];return Object(r.useEffect)((function(){var t=function(t){t.preventDefault();var e=M[t.key];e&&c({type:"move",payload:e})};return document.addEventListener("keydown",t),function(){document.removeEventListener("keydown",t)}}),[c]),Object(R.jsx)(it.Provider,{value:{gameState:i,dispatch:c},children:t.children})},ut=function(){return Object(R.jsx)(st,{children:Object(R.jsx)("div",{className:"container",children:Object(R.jsxs)("div",{className:"gameContainer",children:[Object(R.jsx)(rt,{}),Object(R.jsx)(V,{})]})})})};function lt(){var t=Object(r.useContext)(it);if(void 0===t)throw new Error("useGameContext must be used within a GameContextProvider");return t}var ft=function(){return Object(R.jsx)("div",{children:Object(R.jsx)("main",{children:Object(R.jsx)(ut,{})})})},dt=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,24)).then((function(e){var n=e.getCLS,r=e.getFID,i=e.getFCP,c=e.getLCP,o=e.getTTFB;n(t),r(t),i(t),c(t),o(t)}))};o.a.render(Object(R.jsx)(i.a.StrictMode,{children:Object(R.jsx)(ft,{})}),document.getElementById("root")),dt()}],[[23,1,2]]]);
//# sourceMappingURL=main.721c94bb.chunk.js.map